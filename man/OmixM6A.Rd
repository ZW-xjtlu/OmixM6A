% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{OmixM6A}
\alias{OmixM6A}
\title{OmixM6A: Methylation State Analysis of m6A Modification Sites}
\usage{
OmixM6A(
  m6A,
  Total,
  se = NULL,
  method = c("bbmix", "bmix", "zoibbmix", "zoibmix", "bumix"),
  bbmix_size = NULL,
  cov_threshold = 0
)
}
\arguments{
\item{m6A}{A numeric vector of counts for m6A modifications.}

\item{Total}{A numeric vector of total counts. Must be the same length as `m6A`.}

\item{se}{An optional `SummarizedExperiment` object. If provided, the analysis will store results in its assays and metadata.}

\item{method}{The method for analysis: "bbmix" for beta-binomial mixture, "bmix" for binomial mixture, "zoibmix" for zero-and-one over-inflated binomial mixture, "zoibbmix" for zero-and-one over inflated beta-binomial mixture, "bumix" for binomial and beta(1,1) mixture. Defaults to "bbmix".}

\item{bbmix_size}{An integer specifying the maximum number of sites for the bbmix model. This parameter is for efficiency considerations and only affects the "bbmix" method. The default value is NULL (no subset).}

\item{cov_threshold}{An integer specifying a threshold for subsetting sites. Only sites with a total read count greater than or equal to this value are used for model fitting. The default value is 0.}
}
\value{
If `se` is provided, returns a modified `SummarizedExperiment` object with added assays and metadata containing analysis results. Otherwise, returns a data frame with analysis results including m6A counts, total counts, beta coefficients, posterior probabilities of foreground (prob_fg), p-values, and false discovery rates (fdr).
}
\description{
This function performs statistical analysis on m6A modification sites using different methods including mixtures of two binomial distributions, beta-binomial distributions, or a mixture of binomial and beta(1,1) distributions. It supports analysis on both individual vectors of counts and `SummarizedExperiment` objects.
}
\details{
The function calculates several key statistics:

- `prob_fg`: The posterior probability of a site being a foreground m6A modification. Useful for classifying sites using a Bayesian classifier approach.

- `pvalue`: The posterior predictive p-value, indicating the probability of observing data as or more extreme than the current data under the fitted background model.

- `fdr`: The false discovery rate, adjusting the p-value using the Benjamini-Hochberg (BH) approach.

In case of a `SummarizedExperiment` input, the fitted model parameters are stored in its metadata.
}
\examples{
# Example usage with count vectors
library(SummarizedExperiment)
m6A_se <- readRDS(system.file("extdata", "example_se.rds", package="OmixM6A"))
m6A_counts <- assays(m6A_se)$m6A[,1]
total_counts <- assays(m6A_se)$Total[,1]
result_df <- OmixM6A(m6A_counts, total_counts)
result_df

# Example usage with a SummarizedExperiment object
result_se <- OmixM6A(se = m6A_se)
result_se
metadata(result_se) #Check fitted model parameters

}
