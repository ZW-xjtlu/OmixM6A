% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eval_modules.R
\name{compareGoodnessOfFits}
\alias{compareGoodnessOfFits}
\title{Compare Goodness of Fits for m6A Modification Models}
\usage{
compareGoodnessOfFits(m6A, Total, cov_threshold = 30, bbmix_size = NULL)
}
\arguments{
\item{m6A}{A numeric vector of counts for m6A modifications.}

\item{Total}{A numeric vector of total counts.}

\item{cov_threshold}{A numeric threshold to filter sites based on coverage, only sites with total read count >= `cov_threshold` will be used in evaluation and model fitting. Default is 30.}

\item{bbmix_size}{An integer specifying the maximum number of sites for the bbmix model. This parameter is for efficiency considerations and only affects the "bbmix" method. Default is NULL.}
}
\value{
The function outputs two figures in the current working directory:
1. A histogram plot ("compareGof_hist.pdf") illustrating the degree of similarity between empirical data and simulations from fitted models.
2. A QQ plot ("compareGof_qq.pdf") comparing the goodness of fits of different models.
3. A CSV table ("compareGof_BIC.csv") comparing the Bayesian Information Criterion (BIC) of different models.
}
\description{
This function compares the goodness of fit between several model types for m6A modification data. It generates and saves two types of plots: histograms of beta/m6A level values and quantile-quantile (QQ) plots to assess model fits.
}
\details{
The function generates histograms for each model type, including binomial, binomial mixture, binomial uniform mixture, and beta-binomial mixture.
The histograms compare the observed m6A ratios to the model predictions.
The QQ plot illustrates the fit of the quantiles from the empirical data against the fitted models.
The CSV table contains the BIC values of the five fitted models.
}
\examples{
library(SummarizedExperiment)
m6A_se <- readRDS(system.file("extdata", "example_se.rds", package="OmixM6A"))
m6A_counts <- assays(m6A_se)$m6A[,1]
total_counts <- assays(m6A_se)$Total[,1]
set.seed(123)
compareGoodnessOfFits(m6A_counts, total_counts)
}
